elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 3)
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
k_clust <- kmeans(dist_demo, centers = 2)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
k_clust <- kmeans(dist_demo, centers = 4)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
scaled_demo <- scale(demo_rc[3:10])
dist_demo <- dist(scaled_demo)
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 3)
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 4)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_
scaled_demo <- scale(demo_rc[3:10])
scaled_demo <- scale(demo_rc[3:10])
dist_demo <- dist(scaled_demo)
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 3)
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 4)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
knitr::opts_chunk$set(
warning = FALSE,
message = FALSE
)
library(cluster)
scaled_demo <- scale(demo_rc[3:10])
dist_demo <- dist(scaled_demo)
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
library(tidyverse)
library(cluster)
scaled_demo <- scale(demo_rc[3:10])
dist_demo <- dist(scaled_demo)
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 3)
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10)
k_clust <- kmeans(dist_demo, centers = 4)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
install.packages()
install.packages("NbClust")
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Elbow Method: Total Within-Cluster Sum of Square")
range(1, 10)
range(1, 10, 20)
range(1, 10, 100)
attributes(range(1, 10))
demo_rc[3:10] %>% summarise_all(sd)
dist_demo <- dist(demo_rc)
# Elbow Analysis
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Elbow Method: Total Within-Cluster Sum of Square")
# Silhouette Analysis
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Average Silhouette Method")
# Final Clustering with 3 Clusters
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == max(report_cards$school_year) & !is.na(per_am_in)) %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster)) %>%
left_join(., schools %>% select(dpi_true_id, broad_agency_type), by = "dpi_true_id")
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
dist_demo <- dist(demo_rc)
# Elbow Analysis
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Elbow Method: Total Within-Cluster Sum of Square")
# Silhouette Analysis
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Average Silhouette Method")
# Final Clustering with 3 Clusters
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
library(cluster)
scaled_demo <- scale(demo_rc[3:10])
dist_demo <- dist(scaled_demo)
# Elbow Analysis
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Elbow Method: Total Within-Cluster Sum of Square")
# Silhouette Analysis
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Average Silhouette Method")
# Final Clustering with 3 Clusters
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
dist_demo <- dist(demo_rc)
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Elbow Method: Total Within-Cluster Sum of Square")
# Silhouette Analysis
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Average Silhouette Method")
# Final Clustering with 3 Clusters
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
n_demo <- ach_clustered %>%
group_by(cluser) %>%
summarise(N = n())
n_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise(N = n())
View(n_demo)
k_clust <- kmeans(dist_demo, centers = 2)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
n_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise(N = n())
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
n_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise(N = n())
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
n_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise(N = n())
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
n_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise(N = n())
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
scaled_demo <- scale(demo_rc[3:10])
dist_demo <- dist(scaled_demo)
# Elbow Analysis
tot_withinss <- map_dbl(1:10, function(k) {
model = kmeans(x = dist_demo, centers = k)
model$tot.withinss
})
elbow_df <- data.frame(
k = 1:10,
tot_withinss = tot_withinss
)
elbow_df %>%
ggplot(aes(k, tot_withinss)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Elbow Method: Total Within-Cluster Sum of Square")
# Silhouette Analysis
sil_width <- map_dbl(2:10, function(k){
model <- pam(x = dist_demo, k = k)
model$silinfo$avg.width
})
sil_df <- data.frame(
k = 2:10,
sil_width = sil_width
)
sil_df %>%
ggplot(aes(k, sil_width)) +
geom_line() +
scale_x_continuous(breaks = 2:10) +
labs(title = "Average Silhouette Method")
# Final Clustering with 3 Clusters
k_clust <- kmeans(dist_demo, centers = 3)
ach_clustered <- mke_rc %>%
filter(school_year == "2018-19") %>%
mutate(cluster = as_factor(k_clust$cluster))
n_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise(N = n())
c_demo <- ach_clustered %>%
group_by(cluster) %>%
summarise_at(vars(per_am_in:per_lep, overall_score, sch_ach, sch_growth), .funs = mean, na.rm = TRUE) %>%
modify_at(vars(per_am_in:per_lep), scales::percent)
scale(demo_rc[3:10])
?scale
glimpse(dist_demo)
head(dist_demo)
?kmeans
