names_to = "Payment Portion",
values_to = "amount") %>%
ggplot(aes(payment_number, amount, color = schedule, group = schedule)) +
geom_line() +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = schedule, group = schedule)) +
geom_line() +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`, group = schedule)) +
geom_line() +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule, linetype = "schedule")) +
geom_line() +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
group_by(schedule) %>%
summarise(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
ungroup() %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Payment Portions of Monthly Mortgage",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number")
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number") +
guides(color = element_blank())
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number") +
guides(color = FALSE)
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number") +
guides(color = FALSE,
linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount, color = `Payment Portion`,
group = schedule)) +
geom_line(aes(linetype = schedule)) +
# '#85bb65' is the color of $$$
scale_color_manual(values = c("red", "#85bb65")) +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number", color = "") +
guides(color = FALSE,
linetype = guide_legend(override.aes = list(col = "red"), label = c("Standard Schedule", "Updated Schedule")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number", color = "") +
guides(linetype = guide_legend(override.aes = list(col = "red"),  = c("Standard Schedule", "Updated Schedule")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number", color = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = "Total Interest Paid",
y = "Cumulative Total Payments",
x = "Payment Number", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
y = "Total Interest Paid",
x = "", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Per Month", sep = " "),
y = "Total Interest Paid",
x = "", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(payment_number, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(date, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
full_df %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(date, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "Payment Date", linetype = "") +
guides(linetype = guide_legend(override.aes = list(col = "red")))
blogdown:::serve_site()
servr::daemon_stop(1)
servr::daemon_stop(2)
servr::daemon_list()
both_schedules %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(date, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "Payment Date", linetype = "",
caption = paste("Original Loan Amount: ", original_loan_amount, sep = "")) +
guides(linetype = guide_legend(override.aes = list(col = "red")))
both_schedules <- bind_rows(ss, us)
both_schedules %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(date, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "Payment Date", linetype = "",
caption = paste("Original Loan Amount: ", original_loan_amount, sep = "")) +
guides(linetype = guide_legend(override.aes = list(col = "red")))
both_schedules %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(date, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "Payment Date", linetype = "",
caption = paste("Original Loan Amount: ", scales::dollar(original_loan_amount), sep = "")) +
guides(linetype = guide_legend(override.aes = list(col = "red")))
blogdown:::serve_site()
---
title: Creating an Amortization Calculator in R
author: Spencer Schien
date: ''
slug: creating-amortization-tables-in-r
categories:
- Mortgage Calculator
tags:
- Shiny
- Rmarkdown
- R
subtitle: ''
summary: 'Learn how to build an amortization calculator in R.'
authors: []
lastmod: '2020-02-09T21:35:57-06:00'
featured: no
image: "C:\Users\Spencer\OneDrive - Schools That Can Milwaukee\Data & Impact\R Files\academic-kickstart\static\post\2020-02-09-creating-amortization-tables-in-r_files\figure-html
caption: ''
focal_point: ''
preview_only: no
projects: []
math: true
---
```{r}
knitr::opts_chunk$set(message=FALSE, warning=FALSE)
```
both_schedules %>%
group_by(schedule) %>%
mutate(cum_int = cumsum(interest),
cum_prnp = cumsum(principal)) %>%
pivot_longer(cols = c("cum_int", "cum_prnp"),
names_to = "Payment Portion",
values_to = "amount") %>%
filter(`Payment Portion` != "cum_prnp") %>%
ggplot(aes(date, amount,
group = schedule)) +
geom_line(aes(linetype = schedule), color = "red") +
# Change the theme for better appearance
theme_minimal() +
scale_y_continuous(labels = scales::dollar) +
scale_linetype_discrete(labels = c("Standard Schedule", "Updated Schedule")) +
labs(title = paste("Amount in Interest Saved: ", scales::dollar(sum(interest) - sum(interest1)), sep = ""),
subtitle = paste("By Paying", scales::dollar(extra), "Extra Per Month", sep = " "),
y = "Total Interest Paid",
x = "Payment Date", linetype = "",
caption = paste("Based on ", scales::dollar(original_loan_amount), " loan over " , (term/12), " years."sep = "")) +
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
